import{r as s,j as i,d as P,e as O}from"./index-react.js";import{u as X,P as Y,T as Z,C as A}from"./index-react-three.js";import{M as l}from"./index-threejs.js";import"./index2.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function a(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(r){if(r.ep)return;r.ep=!0;const n=a(r);fetch(r.href,n)}})();const f=()=>!window.invokeNative,C=()=>{},L=(t,o)=>t>0&&t<90?o:t>-180&&t<-90||t>0?-o:o,p=(t,o)=>{const a=s.useRef(C);s.useEffect(()=>{a.current=o},[o]),s.useEffect(()=>{const c=r=>{const{action:n,data:d}=r.data;a.current&&n===t&&a.current(d)};return window.addEventListener("message",c),()=>window.removeEventListener("message",c)},[t])};async function N(t,o,a){if(f())return await new Promise(n=>n);const c={method:"post",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(o)};return await(await fetch(`https://${GetParentResourceName()}/gizmo:${t}`,c)).json()}const D=()=>{const{camera:t}=X();return p("SetCameraPosition",({position:o,rotation:a})=>{t.position.set(o.x,o.z,-o.y),t.rotation.order="YZX",a&&t.rotation.set(l.degToRad(a.x),l.degToRad(L(a.x,a.z)),l.degToRad(a.y)),t.updateProjectionMatrix()}),i.jsx(Y,{position:[0,0,10],makeDefault:!0,onUpdate:o=>o.updateProjectionMatrix()})},I=()=>{const t=s.useRef(null),[o,a]=s.useState(),[c,r]=s.useState("translate"),[n,d]=s.useState(!0),[m,g]=s.useState(!0),[w,h]=s.useState(!0),[R,x]=s.useState(!0),[T,S]=s.useState(!0),[j,y]=s.useState(!0),[z,v]=s.useState(5),[E,b]=s.useState(!1),M=async()=>{const e={handle:o,position:{x:t.current.position.x,y:-t.current.position.z,z:t.current.position.y},rotation:{x:l.radToDeg(t.current.rotation.x),y:l.radToDeg(-t.current.rotation.z),z:l.radToDeg(t.current.rotation.y)}},u=await N("UpdateEntity",e);(u==null?void 0:u.status)!=="ok"&&(t.current.position.set(u.position.x,u.position.z,-u.position.y),t.current.rotation.order="YZX",t.current.rotation.set(l.degToRad(u.rotation.x),l.degToRad(u.rotation.z),l.degToRad(u.rotation.y)))};return p("SetupGizmo",e=>{a(e.handle),e.handle&&(t.current.position.set(e.position.x,e.position.z,-e.position.y),t.current.rotation.order="YZX",t.current.rotation.set(l.degToRad(e.rotation.x),l.degToRad(e.rotation.z),l.degToRad(e.rotation.y)),e.gizmoMode&&r(e.gizmoMode),d(e.allowTranslateX??!0),g(e.allowTranslateY??!0),h(e.allowTranslateZ??!0),x(e.allowRotateX??!0),S(e.allowRotateY??!0),y(e.allowRotateZ??!0),v(e.rotationSnap??5))}),p("SetGizmoMode",e=>{r(e)}),p("EnableRotationSnap",e=>{b(e??!1)}),i.jsx(i.Fragment,{children:i.jsxs(s.Suspense,{fallback:i.jsx("p",{children:"Loading..."}),children:[o!=null&&i.jsx(Z,{size:.5,object:t,mode:c,onObjectChange:M,showX:c==="translate"?n:R,showY:c==="translate"?w:j,showZ:c==="translate"?m:T,rotationSnap:E?z:null}),i.jsx("mesh",{ref:t})]})})},U=()=>i.jsxs(A,{style:{zIndex:1},children:[i.jsx(D,{}),i.jsx(I,{})]});function k(){return i.jsx("div",{style:{width:"100vw",height:"100vh"},children:i.jsx(U,{})})}P.createRoot(document.getElementById("root")).render(i.jsx(O.StrictMode,{children:i.jsx(k,{})}));if(f()){const t=document.getElementById("root");t.style.backgroundImage='url("https://i.imgur.com/3pzRj9n.png")',t.style.backgroundSize="cover",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center"}
